Q1. Find the average portfolio value for each age group in the Investors table
SELECT age, AVG(Portfolio_Value) AS Avg_Portfolio_Value
FROM Investors
GROUP BY age;

Q2. List the total number of transactions for each company, along with the company name.
SELECT Companies.Name, Count(Transactions.Transaction_id) as total_transaction
FROM Transactions
JOIN Stocks ON Transactions.stock_id = Stocks.stock_id
JOIN Companies ON Stocks.company_id = Companies.company_id
GROUP BY Companies."name"

Q3.Find the name of the company with the highest market cap.
SELECT "name", market_cap
FROM Companies
ORDER BY market_cap DESC
LIMIT 1;

Q4. List the names of investors who have made transactions for the stock with the highest closing price.
SELECT "name", stocks.closing_price
FROM Investors
JOIN Transactions ON Investors.Investor_ID = Transactions.Investor_ID
JOIN Stocks ON Transactions.stock_ID = stocks.stock_id
WHERE stocks.closing_price = (SELECT MAX(closing_price) FROM stocks);

Q5. List the company details for companies that have a market cap greater than the average market cap of all companies.
SELECT *
FROM Companies
WHERE market_cap > (
    SELECT AVG(market_cap)
    FROM Companies
);

Q6. Find the name and market cap of the company that was listed most recently.
SELECT "name", market_cap, listing_date
FROM Companies
ORDER BY listing_date DESC
LIMIT 10

Q7. Find the name of the investor with the largest total portfolio value, where the total is calculated by summing all portfolios with the same name.
SELECT "name", portfolio_value
FROM Investors
GROUP BY Investor_ID
ORDER BY SUM(portfolio_value) DESC
LIMIT 1

Q8. List the company names that have more than 2 different stocks associated with them.
SELECT "name"
FROM Companies
JOIN Stocks ON companies.Company_ID = stocks.Company_ID
GROUP BY companies.name
HAVING COUNT(DISTINCT stocks.Stock_ID) > 2

Q9. Find the companies that have paid more than 3 dividends, along with the total dividend amount.
SELECT "name", SUM(dividends.amount) AS total_dividend_amount
FROM companies
JOIN dividends ON companies.Company_ID = dividends.company_id
GROUP BY companies.name
HAVING COUNT(dividends.amount)>3

Q10. 
